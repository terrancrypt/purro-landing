---
import "../styles/global.css";
import ToasterWrapper from "../components/ToasterWrapper";
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/purro-icon.png" />
    <meta name="generator" content={Astro.generator} />
    <title>Purro | Purr-fect Web3 Wallet</title>

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Purro | Built to chill — Ready to win" />
    <meta
      property="og:description"
      content="The purr-fect crypto companion for smart traders. One wallet for Hyperliquid & HyperEVM, unified actions with best routes. Trade smarter, not harder."
    />
    <meta property="og:image" content="/opengraph.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:logo" content="/purro-icon-dark.png" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://purro.xyz" />
    <meta property="og:site_name" content="Purro" />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="Purro | Built to chill — Ready to win"
    />
    <meta
      name="twitter:description"
      content="The purr-fect crypto companion for smart traders. One wallet for Hyperliquid & HyperEVM, unified actions with best routes. Trade smarter, not harder."
    />
    <meta name="twitter:image" content="/opengraph.png" />

    <!-- Additional Meta Tags -->
    <meta
      name="description"
      content="The purr-fect crypto companion for smart traders. One wallet for Hyperliquid & HyperEVM, unified actions with best routes. Trade smarter, not harder."
    />
    <meta
      name="keywords"
      content="Purro, Web3 wallet, Hyperliquid, HyperEVM, crypto trading, DeFi, blockchain wallet, crypto companion, smart trading"
    />
    <meta name="author" content="Purro Team" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&family=Livvic:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,900&display=swap"
      rel="stylesheet"
    /></head
  >

  <body class="font-figtree">
    <slot />
    <ToasterWrapper client:load />

    <script is:inline>
      // Wait for DOM to be ready
      document.addEventListener("DOMContentLoaded", function () {
        console.log("DOM loaded, initializing scroll animations...");

        // Check for reduced motion preference
        const prefersReducedMotion = window.matchMedia(
          "(prefers-reduced-motion: reduce)"
        ).matches;

        if (prefersReducedMotion) {
          // Disable animations for users who prefer reduced motion
          const style = document.createElement("style");
          style.textContent = `
            .scroll-animate,
            .scroll-animate-left,
            .scroll-animate-right,
            .scroll-animate-scale,
            .scroll-animate-stagger {
              opacity: 1 !important;
              transform: none !important;
              transition: none !important;
            }
          `;
          document.head.appendChild(style);
          return;
        }

        // Intersection Observer for scroll animations
        const observerOptions = {
          threshold: 0.05,
          rootMargin: "0px 0px -20px 0px",
        };

        // Mobile-specific observer options
        if (window.innerWidth <= 768) {
          observerOptions.threshold = 0.02;
          observerOptions.rootMargin = "0px 0px -10px 0px";
        }

        const observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              console.log("Element entering viewport:", entry.target);
              entry.target.classList.add("animate-in");

              // Handle staggered animations with reduced complexity on mobile
              const staggeredElements = entry.target.querySelectorAll(
                ".scroll-animate-stagger"
              );
              const isMobile = window.innerWidth <= 768;
              const staggerDelay = isMobile ? 50 : 100;

              staggeredElements.forEach((el, index) => {
                setTimeout(() => {
                  el.classList.add("animate-in");
                }, index * staggerDelay);
              });
            }
          });
        }, observerOptions);

        // Initialize animations
        const animatedElements = document.querySelectorAll(
          ".scroll-animate, .scroll-animate-left, .scroll-animate-right, .scroll-animate-scale"
        );

        console.log("Found animated elements:", animatedElements.length);

        animatedElements.forEach((el) => {
          observer.observe(el);
        });
      });
    </script>
  </body>

  <style is:global>
    html,
    body {
      margin: 0;
      width: 100%;
      height: 100%;
      overflow-x: hidden;
      scroll-behavior: smooth;
    }

    /* Scroll Snap Sections */
    .scroll-snap-section {
      min-height: 100vh;
      scroll-snap-align: start;
      scroll-snap-stop: always;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    /* Footer section - không cần full height nhưng vẫn snap */
    .footer-section {
      scroll-snap-align: end;
      scroll-snap-stop: always;
      min-height: auto;
      position: relative;
    }

    /* Mobile scroll snap adjustments */
    @media (max-width: 768px) {
      .scroll-snap-section {
        scroll-snap-align: start;
        scroll-snap-stop: normal;
      }

      .footer-section {
        scroll-snap-align: end;
        scroll-snap-stop: normal;
      }
    }

    /* Very small screens - disable scroll snap for better UX */
    @media (max-width: 480px) {
      .scroll-snap-section {
        scroll-snap-align: none;
        scroll-snap-stop: normal;
        min-height: auto;
      }

      .footer-section {
        scroll-snap-align: none;
        scroll-snap-stop: normal;
      }
    }

    /* Prevent horizontal scrolling on mobile */
    @media (max-width: 768px) {
      body {
        overflow-x: hidden;
        position: relative;
      }
    }

    /* Header specific animations */
    .header-animate {
      opacity: 0;
      transform: translateY(-20px);
      transition:
        opacity 0.8s ease-out,
        transform 0.8s ease-out;
      animation: headerSlideIn 0.8s ease-out 0.2s forwards;
    }

    @keyframes headerSlideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Scroll Animation Styles */
    .scroll-animate {
      opacity: 0;
      transform: translateY(30px);
      transition:
        opacity 0.8s ease-out,
        transform 0.8s ease-out;
    }

    .scroll-animate.animate-in {
      opacity: 1;
      transform: translateY(0);
    }

    .scroll-animate-left {
      opacity: 0;
      transform: translateX(-30px);
      transition:
        opacity 0.8s ease-out,
        transform 0.8s ease-out;
    }

    .scroll-animate-left.animate-in {
      opacity: 1;
      transform: translateX(0);
    }

    .scroll-animate-right {
      opacity: 0;
      transform: translateX(30px);
      transition:
        opacity 0.8s ease-out,
        transform 0.8s ease-out;
    }

    .scroll-animate-right.animate-in {
      opacity: 1;
      transform: translateX(0);
    }

    .scroll-animate-scale {
      opacity: 0;
      transform: scale(0.9);
      transition:
        opacity 0.8s ease-out,
        transform 0.8s ease-out;
    }

    .scroll-animate-scale.animate-in {
      opacity: 1;
      transform: scale(1);
    }

    .scroll-animate-stagger {
      opacity: 0;
      transform: translateY(20px);
      transition:
        opacity 0.6s ease-out,
        transform 0.6s ease-out;
    }

    .scroll-animate-stagger.animate-in {
      opacity: 1;
      transform: translateY(0);
    }

    /* Mobile-specific adjustments */
    @media (max-width: 768px) {
      .scroll-animate {
        transform: translateY(20px);
      }

      .scroll-animate-left {
        transform: translateX(-20px);
      }

      .scroll-animate-right {
        transform: translateX(20px);
      }

      .scroll-animate-scale {
        transform: scale(0.95);
      }

      .scroll-animate-stagger {
        transform: translateY(15px);
      }

      /* Prevent layout shifts on mobile */
      .scroll-animate,
      .scroll-animate-left,
      .scroll-animate-right,
      .scroll-animate-scale,
      .scroll-animate-stagger {
        will-change: transform, opacity;
        backface-visibility: hidden;
        -webkit-backface-visibility: hidden;
      }
    }

    /* Very small screens */
    @media (max-width: 480px) {
      .scroll-animate {
        transform: translateY(15px);
      }

      .scroll-animate-left {
        transform: translateX(-15px);
      }

      .scroll-animate-right {
        transform: translateX(15px);
      }

      .scroll-animate-stagger {
        transform: translateY(10px);
      }

      /* Further optimize for very small screens */
      .scroll-animate,
      .scroll-animate-left,
      .scroll-animate-right,
      .scroll-animate-scale,
      .scroll-animate-stagger {
        transition-duration: 0.4s;
      }
    }

    /* Delay classes for staggered animations */
    .delay-100 {
      transition-delay: 0.1s;
    }
    .delay-200 {
      transition-delay: 0.2s;
    }
    .delay-300 {
      transition-delay: 0.3s;
    }
    .delay-400 {
      transition-delay: 0.4s;
    }
    .delay-500 {
      transition-delay: 0.5s;
    }
    .delay-600 {
      transition-delay: 0.6s;
    }
  </style>
</html>
